### 1.	Дана схема базы данных в виде следующих отношений.  С помощью операторов SQL создать логическую структуру соответствующих таблиц для хранения в СУБД, используя известные средства поддержания целостности (NOT NULL, UNIQUE, и т.д.). Обосновать выбор типов данных и используемые средства поддержания целостности. При выборе подходящих типов данных использовать информацию о конкретных значениях полей БД (см. прил.1) ###

``` SQL
CREATE TABLE medpersonal (
	id INT UNSIGNED PRIMARY KEY,
	-- INT UNSIGNED: представляет целые числа от 0 до 4294967295, занимает 4 байта.
	-- Определение первичного ключа эквивалентно  определению уникального ключа,
	-- дополненного ограничением NOT NULL.

	last_name VARCHAR(100),
	-- VARCHAR: представляет стоку переменной длины.
	adress VARCHAR(100),
	-- VARCHAR: представляет стоку переменной длины.
	tax TINYINT CHECK (tax >= 0
		AND tax <= 100)
	-- TINYINT: представляет целые числа от -127 до 128, занимает 1 байт.
	-- Проценты от 0 до 100.

);

CREATE TABLE place_of_work (
	id INT UNSIGNED PRIMARY KEY,
	-- INT UNSIGNED: представляет целые числа от 0 до 4294967295, занимает 4 байта.
	-- Определение первичного ключа эквивалентно  определению уникального ключа,
	-- дополненного ограничением NOT  NULL.

	facility VARCHAR(100),
	-- VARCHAR: представляет стоку переменной длины.
	adress VARCHAR(100),
	-- VARCHAR: представляет стоку переменной длины.
	local_budget_allocations TINYINT CHECK (local_budget_allocations >= 0
		AND local_budget_allocations <= 100)
	-- TINYINT: представляет целые числа от -127 до 128, занимает 1 байт.
	-- Проценты от 0 до 100.

);

CREATE TABLE types_of_operations (
	id BIGINT UNSIGNED PRIMARY KEY,
	-- INT UNSIGNED: представляет целые числа от 0 до 4294967295, занимает 4 байта.
	-- Определение первичного ключа эквивалентно  определению уникального ключа,
	-- дополненного ограничением NOT  NULL.

	name VARCHAR(100),
	-- VARCHAR: представляет стоку переменной длины.
	stronghold VARCHAR(100),
	-- VARCHAR: представляет стоку переменной длины.
	stocks INT UNSIGNED,
	-- INT UNSIGNED: представляет целые числа от 0 до 4294967295, занимает 4 байта.
	cost INT UNSIGNED
	-- INT UNSIGNED: представляет целые числа от 0 до 4294967295, занимает 4 байта.
);
```

### 2.	Ввести в ранее созданные таблицы конкретные данные (см. прил. 1). Использовать скрипт-файл из операторов INSERT или вспомогательную утилиту. ###
``` SQL
INSERT INTO medpersonal VALUES
 (001, 'Медина', 	'Вознесенское',	14),
 (002,	'Севастьянов',	'Навашино',	14),
 (003,	'Бессонов',	'Выкса',	10),
 (004,	'Губанов',	'Выкса',	10),
 (005,	'Боева',	'Починки',	5);

INSERT INTO place_of_work VALUES
 (001,	'Районная больница',	'Вознесенское',	10),
 (002,	'Травм. пункт',		'Выкса',	3),
 (003,	'Больница',		'Навашино',	4),
 (004,	'Род. дом',		'Вознесенское',	12),
 (005,	'Больница',		'Починки',	4),
 (006,	'Травм.пункт',		'Лукояново',	3);

INSERT INTO types_of_operations VALUES
 (001,	'Наложение гипса',		'Выкса',	2000,	18000),
 (002,	'Блокада',			'Навашино',	10000,	14000),
 (003,	'Инъекция поливитаминов',	'Навашино',	20000,	11000),
 (004,	'Инъекция алоэ',		'Навашино',	12000,	11000),
 (005,	'ЭКГ',				'Вознесенское',	115,	10000),
 (006,	'УЗИ',				'Вознесенское',	20,	30000),
 (007,	'Флюорография',			'Выкса',	1000,	5000);
```

### 3.	Используя оператор SELECT создать запрос для вывода всех строк каждой таблицы. Проверить правильность ввода. При необходимости произвести коррекцию значений операторами INSERT, UPDATE, DELETE.  ###
``` SQL
SELECT * FROM medpersonal;
```

| id | last\_name | adress | tax |
| :--- | :--- | :--- | :--- |
| 1 | Медина | Вознесенское | 14 |
| 2 | Севастьянов | Навашино | 14 |
| 3 | Бессонов | Выкса | 10 |
| 4 | Губанов | Выкса | 10 |
| 5 | Боева | Починки | 5 |

``` SQL
SELECT * FROM place_of_work;
```

| id | facility | adress | local\_budget\_allocations |
| :--- | :--- | :--- | :--- |
| 1 | Районная больница | Вознесенское | 10 |
| 2 | Травм. пункт | Выкса | 3 |
| 3 | Больница | Навашино | 4 |
| 4 | Род. дом | Вознесенское | 12 |
| 5 | Больница | Починки | 4 |
| 6 | Травм.пункт | Лукояново | 3 |

``` SQL
SELECT * FROM types_of_operations;
```

| id | name | stronghold | stocks | cost |
| :--- | :--- | :--- | :--- | :--- |
| 1 | Наложение гипса | Выкса | 2000 | 18000 |
| 2 | Блокада | Навашино | 10000 | 14000 |
| 3 | Инъекция поливитаминов | Навашино | 20000 | 11000 |
| 4 | Инъекция алоэ | Навашино | 12000 | 11000 |
| 5 | ЭКГ | Вознесенское | 115 | 10000 |
| 6 | УЗИ | Вознесенское | 20 | 30000 |
| 7 | Флюорография | Выкса | 1000 | 5000 |


### 4.	Вывести с помощью запросов: ###
#### a)	различные адреса всех медработников; ####

``` SQL
SELECT DISTINCT adress FROM medpersonal;
```
| adress |
| :--- |
| Вознесенское |
| Навашино |
| Выкса |
| Починки |

#### b)	список всех различных медучреждений; ####

``` SQL
SELECT DISTINCT facility FROM place_of_work;
```
| facility |
| :--- |
| Районная больница |
| Травм. пункт |
| Больница |
| Род. дом |
| Травм.пункт |

#### c)	различные дни, для которых хранится информация о трудовой деятельности. ####
### 5.	Найти: ###
#### a)	даты и номера договоров, когда производились операции на сумму не менее 14000руб. ####
#### b)	размер налога для медперсонала из Выксы или Навашино; ####

``` SQL
SELECT *
FROM medpersonal
WHERE (adress = 'Выкса'
    OR adress = 'Навашино')
;
```

| id | last\_name | adress | tax |
| :--- | :--- | :--- | :--- |
| 2 | Севастьянов | Навашино | 14 |
| 3 | Бессонов | Выкса | 10 |
| 4 | Губанов | Выкса | 10 |


#### c)	название, стоимость и адрес опорного пункта для операций, в названии которых есть слово “Инъекция”, и стоящих более 10000руб. Результат отсортировать по адресу и стоимости. ####
``` SQl
SELECT name, cost, stronghold
from types_of_operations
where cost > 10000
  AND locate('Инъекция', name) > 0
ORDER BY stronghold, cost;
```
| name | cost | stronghold |
| :--- | :--- | :--- |
| Инъекция поливитаминов | 11000 | Навашино |
| Инъекция алоэ | 11000 | Навашино |

### 6.	На основании данных о проведенных операциях вывести в следующем формате все записи: ###
#### a)	дата, фамилия медперсонала, название места работы, название операции; ####
``` SQl

```
#### b)	номер договора, название места работы, количество операций, оплата. Отсортировать по возрастанию оплаты. ####
``` SQl

```
### 7.	Определить: ###
#### a)	фамилии и места проживания медперсонала, проведших более одного наложения гипса в день; ####
``` SQl

```
#### b)	название операций, которые проводили врачи из Вознесенского или Выксы в больницах; ####
``` SQl

```
#### c)	названия и размер отчислений в местный бюджет для тех учреждений, где проводили операции те, у кого налог не менее 7%, но не более 16%. Включить в вывод фамилии таких людей и отсортировать по размеру отчислений и налогу; ####
``` SQl

```
#### d)	даты, идентификаторы операций и фамилии тех, кто проводил операции стоимостью не менее 7000руб больше одного раза. ####
``` SQl

```
### 8.	Создать запрос для модификации всех значений столбца с суммарной величиной оплаты, чтобы он содержал истинную сумму, получаемую медперсоналом ( за вычетом налога). Вывести новые значения. ###
``` SQl

```
### 9.	Расширить таблицу с данными об операциях столбцом, содержащим величину отчислений в местный бюджет для мед.учреждения, где проводилась операция. Создать запрос для ввода конкретных значений во все строки таблицы операций. ###
``` SQl

```
	

###10.	Используя операцию IN (NOT IN)  реализовать следующие запросы: ###
#### a)	найти фамилии медперсонала из Навашино, проводивших инъекции в Выксе; ####
``` SQl

```
#### b)	найти те операции, которые не проводились до среды; ####
``` SQl

```
#### c)	запросы задания 7.с и 7.d. ####
``` SQl

```
### 11.	Используя операции ALL-ANY реализовать следующие запросы: ###
#### a)	найти среди больниц ту, которая имеет наименьший процент отчислений; ####
``` SQl

```
#### b)	найти педперсонал, проводивший операции с самой малой суммой оплаты; ####
``` SQl

```
#### c)	найти цену самой дорогой операции, проведенной в четверг или пятницу; ####
``` SQl

```
#### d)	запрос задания 7.а. ####
``` SQl

```
### 12.	Используя операцию UNION получить места проживания медпероснала и опероные пункты для операций. ###
``` SQl

```
### 13.	Используя операцию EXISTS ( NOT EXISTS ) реализовать нижеследующие запросы. В случае, если для текущего состояния БД запрос будет выдавать пустое множество строк, требуется указать какие добавления в БД необходимо провести. ###
#### a)	определить тот медперсонал, который не работал в субботу; ####
``` SQl

```
#### b)	найти такие операции, которые проводились всеми врачами в Выксе; ####
``` SQl

```
#### c)	определить те места работы, где не делали УЗИ более раза; ####
``` SQl

```
#### d)	определить места работы, где работали все врачи из чужих населенных пунктов. ####
``` SQl

```
### 14.	Реализовать запросы с использованием аггрегатных функций: ###
#### a)	найти число различных мест работы для медперсонала, работавшего в мед.учреждениях Выксы; ####
``` SQl

```
#### b)	определить средний размер налога для медперсонала, производившего иньекции; ####
``` SQl

```
#### c)	кто из медперсонала делал операцию с минимальной стоимостью; ####
``` SQl

```
#### d)	определить количество операций стоимостью не более 15000, проведенных в понедельник Губановым . ####
``` SQl

```
### 15.	Используя средства группировки реализовать следующие запросы: ###
#### a)	определить для каждого дня недели и каждой операции сколько раз ее проводили; ####
``` SQl

```
#### b)	найти для каждого медработника среднюю стоимость всех проведенных им операций; ####
``` SQl

```
#### c)	определить те мед.учреждения, где суммарная величина стоимости всех проведенных в них операций была более 30000; ####
``` SQl

```
#### d)	для каждого дня недели найти число проведенных в этот день операций. ####
``` SQl

```

